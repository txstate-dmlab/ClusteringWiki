$().ready(function(){if($("#reminderForm").length>0){$("#reminderForm").validate({rules:{email:{required:true,maxlength:80,email:true},myCaptchaResp:{requiredCaptcha:true,captchaCheck:true}},messages:{email:{email:"Please enter a valid email address"}}});onEnter("email","sendReminder")}if($("#changePasswordForm").length>0){$("#changePasswordForm").validate({rules:{password:{required:true,alphanumericonly2:true,rangelength:[3,20]},confirm_password:{required:true,equalTo:"#password"},myCaptchaResp:{requiredCaptcha:true,captchaCheck:true}},messages:{password:{required:"Please provide a password",rangelength:"Your password must be between 3 and 20 characters long"},confirm_password:{required:"Please provide a password",equalTo:"Please enter the same password as above"}}});onEnter("password","changePassword");onEnter("confirm_password","changePassword")}$("#myCaptcha").sexyCaptcha("captcha.html")});function sendReminder(){$("#regResponse").removeClass("error").removeClass("success").html("");if(!$("#reminderForm").valid()){return}$("#regResponse").html('Please wait...<img src="includes/images/loading.gif">');var a=$("#email").val();a=$.trim(a);if(a==""){$("#regResponse").html("Email cannot be empty.");$("#regResponse").addClass("error");return}$.ajax({url:"reminder.html?applAction=sendReminder",type:"post",async:true,data:"email="+a,dataType:"json",success:function(c){if(typeof c=="object"&&c.success==true){$("#reminderForm").hide();$("#regResponse").html("A password reminder email has been sent to the email address you specified.  Please click on the link in the email to continue.");$("#regResponse").addClass("success")}else{var b="Invalid server response.";if(typeof c.error){b=c.error}$("#regResponse").html(b);$("#regResponse").addClass("error");b=null}a=null},error:function(c,b){$("#regResponse").html("Server connection error.  Please try again.");$("#regResponse").addClass("error")}})}function changePassword(){$("#regResponse").removeClass("error").removeClass("success").html("");if(!$("#changePasswordForm").valid()){return}$("#regResponse").html('Please wait...<img src="includes/images/loading.gif">');var b=$("#requestKey").val();b=$.trim(b);var a=$("#password").val();if(b==""){$("#regResponse").html("Key cannot be empty.");$("#regResponse").addClass("error");return}$.ajax({url:"changePassword.html?applAction=changePw",type:"post",async:true,data:"requestKey="+b+"&password="+a,dataType:"json",success:function(d){if(typeof d=="object"&&d.success==true){$("#changePasswordForm").hide();$("#regResponse").html("Password changed successfully.  Please log in.");$("#regResponse").addClass("success")}else{var c="Invalid server response.";if(typeof d.error){c=d.error}$("#regResponse").html(c);$("#regResponse").addClass("error");c=null}b=null;a=null},error:function(d,c){$("#regResponse").html("Server connection error.  Please try again.");$("#regResponse").addClass("error")}})};