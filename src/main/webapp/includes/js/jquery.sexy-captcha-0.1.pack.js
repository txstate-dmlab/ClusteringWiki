(function(a){a.fn.sexyCaptcha=function(b){this.each(function(){a(this).load(b,{action:"refresh"},function(){a(".draggable").draggable({containment:"parent",snap:".target",snapMode:"inner",snapTolerance:35,revert:"invalid",opacity:0.75});a(".target").droppable({accept:".draggable",tolerance:"intersect"});a(".target").bind("drop",function(c,d){a("#captchaWrapper").find(".captchaAnswer").val(a(d.draggable).attr("id"));a("#captchaWrapper").find(".draggable").draggable("disable");a("#captchaWrapper").find(".draggable").unbind("click");a("#captchaWrapper").find(".targetWrapper").children(".target").hide();a.post(b,{action:"verify",captcha:a(d.draggable).attr("id")},function(e){if(e.status=="success"){a("#captchaWrapper").find(".targetWrapper").addClass("captchaSuccess").hide().fadeIn("slow")}else{a("#captchaWrapper").find(".targetWrapper").addClass("captchaFail").hide().fadeIn("slow")}},"json")});a(".draggable").bind("click",function(c,d){a("#captchaWrapper").find(".captchaAnswer").val(a(this).attr("id"));a("#captchaWrapper").find(".draggable").draggable("disable");a("#captchaWrapper").find(".draggable").unbind("click");a("#captchaWrapper").find(".targetWrapper").children(".target").hide();a(this).removeClass("draggable");a(this).addClass("target");a("#captchaWrapper").find(".targetWrapper").html(a(this));a.post(b,{action:"verify",captcha:a(this).attr("id")},function(e){if(e.status=="success"){a("#captchaWrapper").find(".targetWrapper").addClass("captchaSuccess").hide().fadeIn("slow")}else{a("#captchaWrapper").find(".targetWrapper").addClass("captchaFail").hide().fadeIn("slow")}},"json")});a(".captchaRefresh").click(function(){a("#captchaWrapper").parent().sexyCaptcha(b);return false})})});return this}})(jQuery);